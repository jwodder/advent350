[This file was written for the Perl 6 and C ports of the Colossal Cave
Adventure, 350 pt. version, at <http://github.com/jwodder/advent350>.]


WIZARD AUTHENTICATION
Wizard authentication is used to restart a game that was saved within the delay
period (but more than a third of the delay ago), start a game while the cave is
closed, and access maintenance mode.  Note that if you use your wizardly powers
to do one of the first two, you will still need to authenticate as a wizard
again if you then try to access maintenance mode.

You will need to know the current magic word (default "DWARF") and the current
magic number (default 11111) according to the magic file (or their default
values if there is no magic file).

GAME: Are you a wizard?
ANSWER: Yes
GAME: Prove it!  Say the magic word!
[Enter the magic word.  Only the first five letters are inspected, and this
 port is case-insensitive.]
GAME: That is not what I thought it was.  Do you know what I thought it was?
ANSWER: No

The game will now print out a random five-letter "word."  You must perform a
series of mathematical operations on it to produce another five-letter word to
give in response (This is the part that frawd(6) automates):
 - Take the current time (specifically, the time at which you expect to enter
   the result) as an hour `h' from 0 through 23 and a minute `m' from 0 through
   59.  Calculate h * 100 + m, change the last digit to a zero, and call this
   number `t'.  For this port of Adventure, the game uses the values returned
   by the localtime(3) function, which should correspond to your current
   timezone settings.  Other ports may vary; consult your wizard if frustration
   lasts longer than four hours.
 - The "value" of a letter is here defined to be a number from 1 through 26
   corresponding to the letter's position in the alphabet (i.e., A has value 1,
   B has value 2, C has value 3, etc.).
 - For `i' from 1 through 5:
  - Take the magnitude of the difference between the value of the i-th letter
    in the word the game gave you and the value of the letter immediately after
    that.  (If i=5, take the difference between the values of the last & first
    letters of the word.)
  - Multiply this number by the i-th digit of the magic number, counting from
    the *end* of the number (i.e., the ones-place is the first digit, the
    tens-place is the second, the hundredths-place is the third, etc.).
  - Add the i-th digit of `t', again counting from the *end* of the number.
  - Divide by 26, take the remainder, and add 1 to it.
  - The result is the value of the i-th letter of the reply.

Once you enter the new word, the game will finally recognize you as a wizard:
GAME: Oh dear, you really *are* a wizard!  Sorry to have bothered you . . .

---------------------------------------

MAINTENANCE MODE
Maintenance mode (a.k.a. "magic mode" or "wizard mode") is invoked by entering
"MAGIC MODE" as the first command immediately after accepting or rejecting the
game's offer of instructions; if you try to access it at any later point, the
command won't be recognized.

The first part of maintenance mode is passing wizard authentication (see
above); if you fail, the game will go back to the normal command-interpreter
mode and act like it doesn't recognize the words "MAGIC MODE".

If you are indeed a wizard:

GAME: Do you wish to see the hours?
If you say "yes", the current cave hours will be shown.

GAME: Do you wish to change the hours?
If you say "yes":

    GAME: New hours specified by defining "prime time".  Give only the hour
	  (e.g. 14, not 14:00 or 2pm).  Enter a negative number after last pair.

    The game will then prompt you to specify the "prime time" hours (the times
    that the cave is closed) for weekdays, weekends, and holidays, in that
    order.  For each type of day, it will print "Prime time on
    [weekdays|weekends|holidays]:" and then alternate prompting between "from:"
    and "till:", to each of which you must respond with a positive integer from
    0 through 23 (24 for "till"), giving pairs of start and (excluded) end
    times for prime time.  A day type may have more than one expanse of prime
    time assigned to it, and overlapping prime time ranges are merged together.
    If you enter a number less than 0 (note that this port treats non-numbers
    as 0) or greater than 23 (24 for "till", indicating that prime time should
    last through the end of the day), or if you enter a "till" time that is
    less than or equal to the corresponding "from" time, the game will stop
    reading times for the current type of day and move on to the next type.

    Once all of the cave hours have been specified, the game will print "New
    hours for Colossal Cave:" and display the new hours.

GAME: Do you wish to (re)schedule the next holiday?

The game keeps track of no more than one holiday at a time, so responding "yes"
will cause the current holiday to be replaced.  (By default, there is no
upcoming holiday.) If you say "yes":

    GAME: To begin how many days from today?
    [Enter a decimal integer.  This number will be added to the current date to
     get the day on which the holiday begins, so, for example, entering "1"
     indicates that the holiday starts tomorrow.]
    GAME: To last how many days (zero if no holiday)?
    [Enter the number of days that the holiday should last for, inclusive.
     Entering "0" causes there to be no upcoming holiday.]
    GAME: To be called what (up to 20 characters)?
    [Enter a line of text.  The first twenty characters of the first word will
     be used as the name of the upcoming holiday.]

GAME: Length of short game (null to leave at %d):
"%d" is replaced by the current maximum length of a short game (default 30); if
a player spends this many turns in a demo, the game will automatically end.
Enter a positive integer to change the limit to, or enter a blank line or a
number less than 1 to leave it unchanged.

GAME: New magic word (null to leave unchanged):
Enter a word.  The first five non-whitespace characters (or fewer, if you enter
a short word) will become the new magic word.  If you enter an empty line, the
magic word will remain unchanged.

GAME: New magic number (null to leave unchanged):
Enter an integer to change the magic number to.  If you enter a blank line or a
value less than one, the magic number will be unchanged.]

GAME: Latency for restart (null to leave at %d):
"%d" is replaced by the current minimum number of minutes that a player must
wait after saving before ey can resume eir game (default 90).  Enter a positive
integer to change the delay to, or enter a blank line or a number less than 1
to leave it unchanged.  However, if you enter a positive integer less than 45,
the game will print "Too small!  Assuming minimum value (45 minutes)." and set
the delay to 45.

GAME: Do you wish to change the message of the day?
If you say "yes", the game will print "Limit lines to 70 chars.  End with null
line."  You will then get to enter one or more lines of text to serve as the
new message of the day, which, when not empty (as it is by default), is
displayed whenever a new game is started.  If you enter a line 70 or more
characters in length (counting the newline), the game will print "Line too
long, retype:" and discard the long line.  If you enter 430 or more characters
in total, the game will print "Not enough room for another line.  Ending
message here." and stop reading input.  Otherwise, reading stops when you enter
a blank line.

GAME: Okay.  You can save this version now.
GAME: Be sure to save your core-image...
The program will then terminate.  On the original PDP-10, the user would then
have to save the program's "core image," which contained the modified magic
settings.  On some systems, the core image would disappear when the program
exited, so the game would instead print "Break out of this and save your
core-image." as the last message and then prompt for input, with the user then
having to suspend the program appropriately.
